the socket.
    std::lock_guard<std::mutex> guard(socket_mutex_)