 not thread-safe.
  assert(socket_requests_in_flight_ == 0 ||
  