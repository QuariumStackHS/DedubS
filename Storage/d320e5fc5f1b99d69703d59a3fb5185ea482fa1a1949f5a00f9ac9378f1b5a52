g better requires either some ugly hacks or breaking portability